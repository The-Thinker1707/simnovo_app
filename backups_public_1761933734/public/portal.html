<!doctype html>
<html lang="en">
<head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Portal — EduConnect</title><link rel="stylesheet" href="/styles.css"/></head>
<body>
  <div class="container">
    <header class="header"><div class="brand"><div class="logo">EDUCONNECT</div></div><nav class="top-nav"><a href="/">Home</a></nav></header>

    <main>
      <h2 style="margin:0 0 6px 0;font-weight:900">Portal — Choose your role</h2>
      <p style="margin:0 0 12px 0;color:var(--muted)">Pick your portal face: Teacher/Admin, Parent/Guardian, or Student/Pupil. Use demo for quick access.</p>

      <div class="role-cards">
        <!-- Teacher/Admin -->
        <div class="role-card teacher" role="button" tabindex="0" onclick="demoLogin('teacher')">
          <div>
            <div class="r-title">Teacher & Administration</div>
            <div class="r-desc">Lesson plans, results, fees, attendance, staff directory and admin tools.</div>
          </div>
          <div class="r-actions">
            <button class="role-btn demo" onclick="demoLogin('teacher'); event.stopPropagation();">Demo Login</button>
            <button class="role-btn" onclick="openManual('teacher'); event.stopPropagation();">Manual Login</button>
          </div>
        </div>

        <!-- Parent/Guardian -->
        <div class="role-card parent" role="button" tabindex="0" onclick="demoLogin('parent')">
          <div>
            <div class="r-title">Parent / Guardian</div>
            <div class="r-desc">View progress per term, complaints, fee status and school announcements.</div>
          </div>
          <div class="r-actions">
            <button class="role-btn demo" onclick="demoLogin('parent'); event.stopPropagation();">Demo Login</button>
            <button class="role-btn" onclick="openManual('parent'); event.stopPropagation();">Manual Login</button>
          </div>
        </div>

        <!-- Student/Pupil -->
        <div class="role-card student" role="button" tabindex="0" onclick="demoLogin('student')">
          <div>
            <div class="r-title">Student / Pupil</div>
            <div class="r-desc">Timetables, homework, e-books, clubs and personal results.</div>
          </div>
          <div class="r-actions">
            <button class="role-btn demo" onclick="demoLogin('student'); event.stopPropagation();">Demo Login</button>
            <button class="role-btn" onclick="openManual('student'); event.stopPropagation();">Manual Login</button>
          </div>
        </div>
      </div>

      <!-- manual login area -->
      <div style="margin-top:22px" id="manual-area">
        <h3 style="margin:0 0 10px 0">Manual login</h3>
        <form id="manual-form" method="post" action="/auth/login" style="display:grid;gap:8px;max-width:420px">
          <input name="email" placeholder="Email" required />
          <input name="password" type="password" placeholder="Password" required />
          <div style="display:flex;gap:8px">
            <button type="submit">Sign in</button>
            <a href="/" class="role-btn">Back</a>
          </div>
        </form>
      </div>

    </main>

    <footer style="margin-top:28px;color:var(--muted);font-size:13px">Demo accounts: teacher@example.com / teach123 • parent@example.com / parent123 • student@example.com / student123</footer>
  </div>

  <script>
    // demo credentials mapping
    const creds = {
      teacher: { email: 'teacher@example.com', password: 'teach123', redirect: '/teacher.html' },
      parent: { email: 'parent@example.com', password: 'parent123', redirect: '/parent.html' },
      student: { email: 'student@example.com', password: 'student123', redirect: '/student.html' }
    };

    function demoLogin(role){
      const c = creds[role];
      if(!c) return;
      // perform POST to /auth/login via fetch; then redirect based on response cookies (server redirects)
      fetch('/auth/login', {
        method: 'POST',
        headers: {'Content-Type':'application/x-www-form-urlencoded'},
        body: 'email=' + encodeURIComponent(c.email) + '&password=' + encodeURIComponent(c.password)
      }).then(res=>{
        // server redirects on success; follow by navigating to the role page to be safe
        window.location.href = c.redirect;
      }).catch(e=>{
        alert('Demo login failed');
      });
    }

    function openManual(role){
      document.querySelector('#manual-form input[name="email"]').value = (role === 'teacher') ? 'teacher@example.com' : (role === 'parent') ? 'parent@example.com' : 'student@example.com';
      document.querySelector('#manual-form input[name="password"]').value = '';
      window.scrollTo({top:document.getElementById('manual-area').offsetTop-20, behavior:'smooth'});
    }
  </script>
</body>
</html>
