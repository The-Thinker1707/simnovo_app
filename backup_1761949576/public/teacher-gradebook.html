<!doctype html><html lang="en"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Teacher — Gradebook</title>
<link rel="stylesheet" href="/styles.css">
<link rel="stylesheet" href="/teacher.css">
</head><body>
<div class="app">
  <header class="header"><div class="brand"><div class="logo" style="background:linear-gradient(135deg,#062a5b,#0b76d1)">T</div><div><div class="h1">Gradebook & Results</div><div class="h2 small">Enter results and publish</div></div></div><nav><a class="back-button nav-back" href="#">Back</a> <a class="back-button" href="/teacher-dashboard.html">Dashboard</a></nav></header>

  <main style="margin-top:12px">
    <div class="card">
      <h3 style="margin:0">Publish Result (POST to /api/results)</h3>
      <p class="small">Provide a valid demo token in Authorization if backend requires auth.</p>
      <form id="gradeForm">
        <input class="input" id="token" placeholder="Auth token (optional)"><br><br>
        <input class="input" id="student_id" placeholder="Student ID (number)" required><br><br>
        <input class="input" id="term" placeholder="Term e.g. 2025_Term1" required><br><br>
        <input class="input" id="subject" placeholder="Subject" required><br><br>
        <input class="input" id="score" placeholder="Score (number)" required><br><br>
        <input class="input" id="max_score" placeholder="Max Score (100)" required><br><br>
        <button class="back-button" type="submit">Publish Result</button>
      </form>
      <div id="gradeResult" style="margin-top:12px"></div>
    </div>
  </main>

  <footer class="footer card" style="margin-top:12px">© EduConnect 2025</footer>
</div>

<script>
document.getElementById('gradeForm').addEventListener('submit', async function(e){
  e.preventDefault();
  const token = document.getElementById('token').value.trim();
  const payload = {
    student_id: Number(document.getElementById('student_id').value),
    term: document.getElementById('term').value.trim(),
    subject: document.getElementById('subject').value.trim(),
    score: Number(document.getElementById('score').value),
    max_score: Number(document.getElementById('max_score').value)
  };
  const headers = {'Content-Type':'application/json'};
  if(token) headers['Authorization'] = 'Bearer '+token;
  try{
    const res = await fetch('/api/results', {method:'POST', headers, body: JSON.stringify(payload)});
    const data = await res.json();
    document.getElementById('gradeResult').innerText = JSON.stringify(data, null, 2);
  }catch(err){
    document.getElementById('gradeResult').innerText = 'Error: '+err.message;
  }
});
</script>

</body></html>
