<!doctype html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Student Dashboard</title><link rel="stylesheet" href="/styles.css"/><script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script></head><body>
<div class="app">
  <div class="header"><div class="brand"><div class="logo">EC</div><div><div class="h1">Student Dashboard</div><div class="h2">Pupil One</div></div></div><div id="live-dt" class="h2"></div></div>
  <a class="back-button" href="javascript:history.back()">Back</a>
  <div class="main" style="margin-top:12px">
    <h2>Academic Snapshot</h2>
    <div class="cards" style="margin-top:12px">
      <div class="card"><h3>Homework</h3><p>3 pending</p><a href="/student-homework.html" class="back-button">Open</a></div>
      <div class="card"><h3>Timetable</h3><p>Open your timetable</p><a href="/student-home.html" class="back-button">Open</a></div>
      <div class="card"><h3>Clubs</h3><p>Drama, Football, Science</p><a href="/student-clubs.html" class="back-button">Open</a></div>
      <div class="card"><h3>Resources</h3><p>Library & study materials</p><a href="/student-home.html" class="back-button">Open</a></div>
    </div>
    <div class="chart-wrap"><canvas id="scoreChart" width="600" height="260"></canvas></div>
    <table class="table" id="results-table"><thead><tr><th>Term</th><th>Subject</th><th>Score</th><th>Max</th></tr></thead><tbody></tbody></table>
  </div>
  <div class="footer">Â© EduConnect 2025</div>
</div>
<script>
function updateDT(){document.getElementById('live-dt').textContent=(new Date()).toLocaleString();}
setInterval(updateDT,1000); updateDT();
async function loadResults(){ try{
  const r=await fetch('/api/results/student/1'); if(!r.ok) throw 'fail';
  const j=await r.json();
  const labels=j.results.map(x=>x.term), data=j.results.map(x=>x.score);
  const ctx=document.getElementById('scoreChart');
  new Chart(ctx,{type:'line',data:{labels,datasets:[{label:'Mathematics',data,tension:0.35,borderWidth:3,pointRadius:6,fill:false}]},options:{responsive:true,scales:{y:{suggestedMin:50,suggestedMax:100}}}});
  const tbody=document.querySelector('#results-table tbody'); tbody.innerHTML=''; j.results.forEach(rw=>{
    const tr=document.createElement('tr'); tr.innerHTML=`<td>${rw.term}</td><td>${rw.subject}</td><td>${rw.score}</td><td>${rw.max_score}</td>`; tbody.appendChild(tr);
  });
}catch(e){console.error(e)}}
loadResults();
</script>
</body></html>
