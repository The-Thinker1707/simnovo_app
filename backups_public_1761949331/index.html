<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EduConnect — Portal</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="brand">
        <div class="logo">EDUCONNECT</div>
        <div>
          <div style="font-weight:800;font-size:14px">Unified School Portal</div>
          <div style="font-size:12px;color:var(--muted)">Teachers • Parents • Students</div>
        </div>
      </div>
      <nav class="top-nav">
        <a href="/portal.html">Portal</a>
        <a href="/portal.html" class="cta">Open Portal</a>
      </nav>
    </header>

    <!-- HERO -->
    <section class="hero-wrap">
      <div class="hero-card">
        <div class="h-left">
          <h1 class="h-title">Professional school portal — built for clarity</h1>
          <p class="h-lead">Unified dashboards for teachers, parents and students. View results, timetables, homework, fees and more.</p>
          <div class="h-actions">
            <a href="/portal.html" class="cta" style="padding:10px 16px;border-radius:10px;text-decoration:none;">Open Portal</a>
            <a href="#features" style="padding:10px 14px;border-radius:10px;background:transparent;border:1px solid rgba(7,20,40,0.06);text-decoration:none;color:var(--muted)">Explore features</a>
          </div>
        </div>

        <div style="min-width:220px">
          <div style="font-size:12px;color:var(--muted);font-weight:700">48 Departments</div>
          <div style="margin-top:8px;font-size:26px;font-weight:900" id="stat-users">—</div>
          <div style="font-size:12px;color:var(--muted)">Total users</div>
        </div>
      </div>

      <!-- stats row -->
      <div class="stats" style="margin-top:12px">
        <div class="stat">
          <h4>Users</h4>
          <strong id="s-users">—</strong>
        </div>
        <div class="stat">
          <h4>Announcements</h4>
          <strong id="s-ann">—</strong>
        </div>
        <div class="stat">
          <h4>Lessons</h4>
          <strong id="s-lessons">—</strong>
        </div>
        <div class="stat">
          <h4>Departments</h4>
          <strong>48</strong>
        </div>
      </div>
    </section>

    <!-- FEATURES -->
    <section id="features" style="margin-top:20px">
      <h2 style="margin:0 0 12px 0">Features</h2>
      <div class="features">
        <a class="feature-card f-teacher" href="/teacher.html">
          <div class="f-title">Teacher / Admin</div>
          <div class="f-sub">Results • Lesson plans • Entry tools</div>
        </a>

        <a class="feature-card f-parent" href="/parent.html">
          <div class="f-title">Parents</div>
          <div class="f-sub">Progress • Complaints • Fees</div>
        </a>

        <a class="feature-card f-student" href="/student.html">
          <div class="f-title">Students</div>
          <div class="f-sub">Timetables • Homework • Reflections</div>
        </a>

        <a class="feature-card f-analytics" href="/teacher.html#analytics">
          <div class="f-title">Analytics</div>
          <div class="f-sub">Performance snapshot</div>
        </a>

        <a class="feature-card f-library" href="/library.html">
          <div class="f-title">Library</div>
          <div class="f-sub">Digital books & resources</div>
        </a>

        <a class="feature-card f-events" href="/events.html">
          <div class="f-title">Events</div>
          <div class="f-sub">Clubs, calendar</div>
        </a>

        <a class="feature-card f-contacts" href="/staff.html">
          <div class="f-title">Contacts</div>
          <div class="f-sub">Staff directory</div>
        </a>

        <a class="feature-card f-more" href="/admin.html">
          <div class="f-title">Admin</div>
          <div class="f-sub">Users, links & settings</div>
        </a>
      </div>
    </section>

    <!-- ANNOUNCEMENTS -->
    <section style="margin-top:20px">
      <h3 style="margin:0 0 8px 0">Announcements</h3>
      <div class="card">
        <ul id="announcements" style="margin:0;padding-left:18px;color:var(--muted)"></ul>
      </div>
    </section>

    <footer class="footer">
      <div>© EduConnect Prototype • 2025</div>
      <div style="font-size:13px;color:var(--muted)">Demo accounts available on the portal page</div>
    </footer>
  </div>

  <script>
    // populate quick stats and announcements from backend endpoints
    async function loadHomeData(){
      try{
        const res = await fetch('/api/analytics');
        if(res.ok){
          const d = await res.json();
          document.getElementById('s-users').textContent = d.totals?.users ?? '—';
          document.getElementById('s-ann').textContent = d.totals?.announcements ?? '—';
          document.getElementById('s-lessons').textContent = d.totals?.lessons ?? '—';
          document.getElementById('stat-users').textContent = d.totals?.users ?? '—';
        }
      }catch(e){
        console.warn('analytics fetch failed', e);
      }

      try{
        const r = await fetch('/api/announcements');
        if(r.ok){
          const anns = await r.json();
          const ul = document.getElementById('announcements');
          ul.innerHTML = '';
          if(!anns || anns.length === 0){
            ul.innerHTML = '<li style="color:var(--muted)">No announcements</li>';
          } else {
            anns.forEach(a=>{
              const li = document.createElement('li');
              li.style.marginBottom = '8px';
              const title = document.createElement('div');
              title.style.fontWeight = 800;
              title.textContent = a.title;
              const body = document.createElement('div');
              body.style.fontSize = '13px';
              body.style.color = 'var(--muted)';
              body.textContent = a.body || '';
              li.appendChild(title);
              li.appendChild(body);
              ul.appendChild(li);
            });
          }
        }
      }catch(e){
        console.warn('ann fetch failed', e);
      }
    }

    document.addEventListener('DOMContentLoaded', loadHomeData);
  </script>
</body>
</html>
