<!doctype html><html lang="en"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Parent — Complaints</title>
<link rel="stylesheet" href="/styles.css">
<link rel="stylesheet" href="/parent.css">
</head><body>
<div class="app">
  <header class="header"><div class="brand"><div class="logo" style="background:linear-gradient(135deg,#064342,#0bb5a1)">P</div><div><div class="h1">Complaints & Messages</div><div class="h2 small">Raise or view complaints</div></div></div><nav><a class="back-button nav-back" href="#">Back</a> <a class="back-button" href="/parent-dashboard.html">Dashboard</a></nav></header>

  <main style="margin-top:12px">
    <div class="card">
      <h3 style="margin:0">New Complaint</h3>
      <p class="small">Provide your token (optional) to submit as the logged-in parent.</p>
      <form id="complaintForm">
        <input class="input" id="token" placeholder="Auth token (optional)"><br><br>
        <input class="input" id="about_student" placeholder="About Student ID (number)" required><br><br>
        <select class="input" id="category"><option value="behavior">behavior</option><option value="academic">academic</option><option value="other">other</option></select><br><br>
        <textarea class="input" id="message" placeholder="Message" required></textarea><br><br>
        <button class="back-button" type="submit">Submit Complaint</button>
      </form>
      <div id="complaintResult" style="margin-top:12px"></div>
    </div>
  </main>

  <footer class="footer card" style="margin-top:12px">© EduConnect 2025</footer>
</div>

<script>
document.getElementById('complaintForm').addEventListener('submit', async function(e){
  e.preventDefault();
  const token = document.getElementById('token').value.trim();
  const payload = {
    about_student: Number(document.getElementById('about_student').value),
    category: document.getElementById('category').value,
    message: document.getElementById('message').value.trim()
  };
  const headers = {'Content-Type':'application/json'};
  if(token) headers['Authorization']='Bearer '+token;
  try{
    const res = await fetch('/api/complaints', {method:'POST', headers, body: JSON.stringify(payload)});
    const data = await res.json();
    document.getElementById('complaintResult').innerText = JSON.stringify(data, null, 2);
  }catch(err){
    document.getElementById('complaintResult').innerText = 'Error: '+err.message;
  }
});
</script>
</body></html>
